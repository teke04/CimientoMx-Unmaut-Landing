RewriteEngine On
# RewriteBase /unmaut/  # Comentado para que funcione tanto en local como en producción
Options -Indexes

# Protección de archivos sensibles
<FilesMatch "\.(php|sql|md|json|config|log|bak|backup)$">
  Require all denied
</FilesMatch>
<Files "index.php">
  Require all granted
</Files>

# Optimización y seguridad
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain text/html text/xml text/css application/javascript application/json
</IfModule>

<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/* "access plus 6 months"
  ExpiresByType text/css "access plus 6 months"
  ExpiresByType application/javascript "access plus 6 months"
</IfModule>

# Permitir recursos estáticos
RewriteCond %{REQUEST_URI} ^/recursos/ [NC]
RewriteRule .* - [L]

# Enrutar todo lo demás a index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php [QSA,L]